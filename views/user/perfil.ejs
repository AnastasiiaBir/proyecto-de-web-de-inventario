<!-- views/user/perfil.ejs -->
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Perfil</title>
  <link rel="stylesheet" href="/styles.css">
</head>
<body>
  <h1 style="text-align:center;">Mi Perfil</h1>

  <!-- Foto de perfil -->
  <div style="text-align:center; margin-bottom:20px;">
    <% if (user.foto) { %>
      <img src="<%= user.foto %>" 
           alt="Foto de perfil" 
           style="width:150px; height:150px; border-radius:50%; object-fit:cover;">
    <% } else { %>
      <div style="width:150px; height:150px; border-radius:50%; background:#ddd; display:inline-block;"></div>
    <% } %>
    
    <form action="/user/upload-photo" method="POST" enctype="multipart/form-data" style="margin-top:10px;">
      <input type="file" name="foto" accept="image/*">
      <button type="submit">Subir Foto</button>
    </form>
  </div>

  <table>
    <tbody>
      <tr>
        <th>Nombre:</th>
        <td><%= user.nombre %></td>
      </tr>
      <tr>
        <th>Email:</th>
        <td><%= user.email %></td>
      </tr>
      <tr>
        <th>Rol:</th>
        <td><%= user.rol_id === 1 ? 'Administrador' : 'Usuario' %></td>
      </tr>
    </tbody>
  </table>

  <!-- Cambiar contraseña -->
  <div style="margin-top:30px;">
    <h2>Cambiar Contraseña</h2>
    <form action="/user/change-password" method="POST">
      <div>
        <label>Contraseña actual:</label>
        <input type="password" name="currentPassword" required>
      </div>
      <div>
        <label>Nueva contraseña:</label>
        <input type="password" name="newPassword" required>
      </div>
      <div>
        <label>Confirmar nueva contraseña:</label>
        <input type="password" name="confirmPassword" required>
      </div>
      <button type="submit">Cambiar Contraseña</button>
    </form>
  </div>

  <div style="margin-top:20px;">
    <a href="/user/dashboard">Volver al dashboard</a>
  </div>
</body>
</html>